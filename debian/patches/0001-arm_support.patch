From 5e279b1a236ef9ec666e28801a8a8bfaddfc4a52 Mon Sep 17 00:00:00 2001
From: Joe Burmeister <joe@suaveairapps.co.uk>
Date: Wed, 15 Oct 2014 12:00:05 +0000
Subject: [PATCH] Add ARMhf support.

---
 Platform/Linux/Build/Common/Platform.Arm |  2 +-
 Platform/Linux/CreateRedist/RedistMaker  | 30 ++++++++++++++++--------------
 2 files changed, 17 insertions(+), 15 deletions(-)

diff --git a/Platform/Linux/Build/Common/Platform.Arm b/Platform/Linux/Build/Common/Platform.Arm
index 32cc34d..ecc5540 100644
--- a/Platform/Linux/Build/Common/Platform.Arm
+++ b/Platform/Linux/Build/Common/Platform.Arm
@@ -1,7 +1,7 @@
 ifeq "$(CFG)" "Release"
 
     # Hardware specifying flags
-    CFLAGS += -march=armv7-a -mtune=cortex-a8 -mfpu=neon -mfloat-abi=softfp #-mcpu=cortex-a8
+    CFLAGS += -march=armv7-a -mtune=cortex-a8 -mfpu=neon #-mcpu=cortex-a8
 
     # Optimization level, minus currently buggy optimizing methods (which break bit-exact)
     CFLAGS += -O3 -fno-tree-pre -fno-strict-aliasing
diff --git a/Platform/Linux/CreateRedist/RedistMaker b/Platform/Linux/CreateRedist/RedistMaker
index 14fc068..3a6e0e5 100755
--- a/Platform/Linux/CreateRedist/RedistMaker
+++ b/Platform/Linux/CreateRedist/RedistMaker
@@ -22,20 +22,22 @@ if [ $# -eq 1 ]
 then
 	PLATFORM=$1
 else
-	case $MACHINE_TYPE in
-	x86 | i386 | i686)
-		PLATFORM="x86" ;;
-	x86_64)
-		PLATFORM="x64" ;;
-	arm)
-		PLATFORM="Arm" ;;
-	ppc)
-		PLATFORM="Powerpc" ;;
-	*)
-		echo "Unknown machine type: $MACHINE_TYPE"
-		exit 1
-		;;
-	esac
+    if [[ $MACHINE_TYPE == arm* ]] ; then
+            PLATFORM="Arm"
+    else
+            case $MACHINE_TYPE in
+            x86 | i386 | i686)
+                    PLATFORM="x86" ;;
+            x86_64)
+                    PLATFORM="x64" ;;
+            ppc)
+                    PLATFORM="Powerpc" ;;
+            *)
+                    echo "Unknown machine type: $MACHINE_TYPE"
+                    exit 1
+                    ;;
+            esac
+    fi
 fi
 
 export PLATFORM
-- 
1.9.1

